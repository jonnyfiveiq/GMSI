FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBjZW50b3M3LXNhdGVsbGl0ZS1hcGIKZGVzY3JpcHRpb246\
IGNlbnRvczcgdmlhIFNhdGVsbGl0ZSBvbiBQaHlzaWNhbApiaW5kYWJsZTogZmFsc2UKYXN5bmM6\
IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBjZW50b3M3IHZpYSBTYXRlbGxpdGUg\
b24gUGh5c2ljYWwKcGxhbnM6Ci0gbmFtZTogZGVmYXVsdAogIGRlc2NyaXB0aW9uOiBEZWZhdWx0\
IGRlcGxveW1lbnQgcGxhbiBmb3IgY2VudG9zNyB2aWEgU2F0ZWxsaXRlIG9uIFBoeXNpY2FsCiAg\
ZnJlZTogdHJ1ZQogIG1ldGFkYXRhOiB7fQogIHBhcmFtZXRlcnM6CiAgLSB0aXRsZTogU2F0ZWxs\
aXRlIFJlcXVlc3RlcgogICAgbmFtZTogc2F0ZWxsaXRlX3VzZXIKICAgIHR5cGU6IHN0cmluZwog\
ICAgcmVxdWlyZWQ6IHRydWUKICAgIGRpc3BsYXlfZ3JvdXA6IFNhdGVsbGl0ZSBDcmVkZW50aWFs\
cwogIC0gdGl0bGU6IFNhdGVsbGl0ZSBQYXNzd29yZAogICAgbmFtZTogc2F0ZWxsaXRlX3Bhc3N3\
b3JkCiAgICB0eXBlOiBzdHJpbmcKICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgIHJlcXVp\
cmVkOiB0cnVlCiAgICBkaXNwbGF5X2dyb3VwOiBTYXRlbGxpdGUgQ3JlZGVudGlhbHMKICAtIG5h\
bWU6IG1pbl9tZW1vcnkKICAgIHRpdGxlOiBNaW5pbXVtIE1lbW9yeSAoTUIpCiAgICBkZWZhdWx0\
OiAnJwogICAgZGlzcGxheV9ncm91cDogUGh5c2ljYWwgUmVxdWlyZW1lbnRzCiAgICB0eXBlOiBp\
bnRlZ2VyCiAgICByZXF1aXJlZDogZmFsc2UKICAtIG5hbWU6IG1pbl9kaXNrc19zaXplCiAgICB0\
aXRsZTogTWluaW11bSBEaXNrIFNpemUgKE1CKQogICAgZGVmYXVsdDogJycKICAgIGRpc3BsYXlf\
Z3JvdXA6IFBoeXNpY2FsIFJlcXVpcmVtZW50cwogICAgdHlwZTogaW50ZWdlcgogICAgcmVxdWly\
ZWQ6IGZhbHNlCiAgLSBuYW1lOiBzZXJ2ZXJfbmFtZQogICAgdGl0bGU6IFNlcnZlciBOYW1lCiAg\
ICBkZWZhdWx0OiAnJwogICAgZGlzcGxheV9ncm91cDogUHJvdmlzaW9uIERldGFpbAogICAgdHlw\
ZTogc3RyaW5nCiAgICByZXF1aXJlZDogdHJ1ZQogIC0gbmFtZTogaG9zdF9ncm91cF9uYW1lCiAg\
ICB0aXRsZTogSG9zdCBHcm91cCBOYW1lCiAgICBkZWZhdWx0OiAnQ2VudE9TIDcgdmlhIEtpY2tz\
dGFydC9QWEUnCiAgICBkaXNwbGF5X2dyb3VwOiBQcm92aXNpb24gRGV0YWlsCiAgICB0eXBlOiBz\
dHJpbmcKICAgIHJlcXVpcmVkOiB0cnVlCgoKICAgIAo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
